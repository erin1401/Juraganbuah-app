<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Item Keluar</title>

<link rel="stylesheet" href="../css/styles.css">
<script src="../js/data.js"></script>
<script src="../js/auth.js"></script>
</head>

<body>

<div class="topbar">
  <div class="logo">
    <img src="../assets/logo.png">
    <strong>Item Keluar</strong>
  </div>
  <nav>
    <a href="dashboard.html">Dashboard</a>
    <a href="stock-out.html" class="active">Item Keluar</a>
    <a href="items.html">Item</a>
    <a href="#" onclick="logout()">Logout</a>
  </nav>
</div>

<div class="container">

<div class="card">
  <select id="item"></select>
  <input type="number" id="qty" placeholder="Jumlah keluar">
  <button type="button" class="btn btn-red" onclick="removeStock()">Proses</button>
</div>

</div>

<script>
const items = DataStore.getItems();
const select = document.getElementById("item");

items.forEach(i => {
  select.innerHTML += `<option value="${i.id}">${i.name} (Stok: ${i.stock})</option>`;
});

function removeStock() {
  const id = select.value;
  const qty = +document.getElementById("qty").value;

  const items = DataStore.getItems();
  const item = items.find(i => i.id === id);

  if (qty > item.stock) return alert("Stok tidak cukup");

  item.stock -= qty;
  DataStore.saveItems(items);
  alert("Item keluar dicatat");
}
</script>

</body>
</html>
