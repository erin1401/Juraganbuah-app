<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Stok Opname</title>

<link rel="stylesheet" href="../css/styles.css">
<script src="../js/data.js"></script>
<script src="../js/auth.js"></script>
</head>

<body>

<div class="topbar">
  <div class="logo">
    <img src="../assets/logo.png">
    <strong>Stok Opname</strong>
  </div>
  <nav>
    <a href="dashboard.html">Dashboard</a>
    <a href="opname.html" class="active">Opname</a>
    <a href="#" onclick="logout()">Logout</a>
  </nav>
</div>

<div class="container">

<div class="card">
  <table class="table">
    <thead>
      <tr>
        <th>Item</th>
        <th>Stok Sistem</th>
        <th>Stok Fisik</th>
      </tr>
    </thead>
    <tbody id="body"></tbody>
  </table>

  <button type="button" class="btn btn-green" onclick="save()">Simpan Opname</button>
</div>

</div>

<script>
const body = document.getElementById("body");
const items = DataStore.getItems();

items.forEach(i => {
  body.innerHTML += `
    <tr>
      <td>${i.name}</td>
      <td>${i.stock}</td>
      <td><input type="number" value="${i.stock}"></td>
    </tr>
  `;
});

function save() {
  const rows = body.querySelectorAll("tr");
  rows.forEach((r, idx) => {
    items[idx].stock = +r.querySelector("input").value;
  });
  DataStore.saveItems(items);
  alert("Opname tersimpan");
}
</script>

</body>
</html>
