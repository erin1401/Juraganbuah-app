<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Dashboard | Juragan Buah POS</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet" href="../css/styles.css">

<!-- CORE -->
<script src="../js/auth.js"></script>
<script src="../js/sidebar.js"></script>
<script src="../js/data.js"></script>
</head>

<body>

<script>
  // WAJIB setelah auth.js
  Auth.requireLogin();
</script>

<div class="app">

<!-- ================= SIDEBAR ================= -->
<aside class="sidebar">
  <div class="sidebar-header">
    <img src="../assets/logo.png" alt="logo">
    <span>Juragan Buah</span>
  </div>

  <nav class="menu">
    <a class="active" href="dashboard.html">ğŸ  Dashboard</a>
    <a href="items.html">ğŸ“¦ Master Item</a>
    <a href="stock-in.html">ğŸ“¥ Item Masuk</a>
    <a href="stock-out.html">ğŸ“¤ Item Keluar</a>
    <a href="sales.html">ğŸ§¾ Penjualan</a>
    <a href="report-sales.html">ğŸ“Š Laporan Penjualan</a>
    <a href="report-stock.html">ğŸ“¦ Laporan Stok</a>
    <a href="report-profit.html">ğŸ’° Laba Rugi</a>
    <a href="#" onclick="Auth.logout()">ğŸšª Logout</a>
  </nav>
</aside>

<!-- ================= CONTENT ================= -->
<main class="content">

<header class="content-header">
  <button id="sidebarToggle">â˜°</button>
  <div>
    <h2>Dashboard</h2>
    <small>Ringkasan Sistem</small>
  </div>
  <span id="currentUser"></span>
</header>

<section class="summary-grid">

  <div class="summary-card">
    <span>Total Item</span>
    <strong id="totalItems">0</strong>
  </div>

  <div class="summary-card">
    <span>Total Stok</span>
    <strong id="totalStock">0</strong>
  </div>

  <div class="summary-card">
    <span>Total Penjualan</span>
    <strong id="totalSales">Rp 0</strong>
  </div>

</section>

<section class="card chart-card">
  <h3>Grafik Penjualan</h3>
  <canvas id="salesChart"></canvas>
</section>

</main>

<!-- ================= SUMMARY ================= -->
 <section class="summary-grid">

    <div class="card" style="height:300px">
  <h3>Grafik Penjualan</h3>
  <canvas id="salesChart"></canvas>
</div>

  <div class="summary-card">
    <h4>Total Item</h4>
    <strong id="totalItems">0</strong>
  </div>

  <div class="summary-card">
    <h4>Total Stok</h4>
    <strong id="totalStock">0</strong>
  </div>

  <div class="summary-card">
    <h4>Total Penjualan</h4>
    <strong id="totalSales">Rp 0</strong>
  </div>

</section>

<!-- ================= INFO ================= -->
<section class="card">
  <h3>Status Sistem</h3>
  <p>
    âœ… Login aman<br>
    âœ… Sidebar stabil<br>
    â³ Grafik & laporan akan aktif di tahap berikutnya
  </p>
</section>

</main>
</div>

<!-- ================= SCRIPT ================= -->
<script>
  // User info
  const user = Auth.getUser();
  document.getElementById("currentUser").innerText =
    user.username + " (" + user.role + ")";

  // Load summary (aman walau data kosong)
  const items = DataStore.getItems() || [];
  const sales = DataStore.getSales() || [];

  document.getElementById("totalItems").innerText =
    items.length;

  document.getElementById("totalStock").innerText =
    items.reduce((a, b) => a + (b.stock || 0), 0);

  document.getElementById("totalSales").innerText =
    "Rp " + sales.reduce((a, b) => a + (b.total || 0), 0)
      .toLocaleString("id-ID");
</script>

</body>
</html>



